# QQ Bot

这是一个基于 Python 的 QQ 机器人项目，通过 WebSocket 与 QQ 客户端进行通信。机器人能够处理群聊消息，并集成了多种功能，包括：

-   **大模型集成**: 利用大模型进行智能回复。
-   **塔罗牌占卜**: 提供塔罗牌占卜功能。
-   **每日运势**: 提供基于天气、诗词、一言等的每日运势。
-   **文件处理**: 支持对图片和音频文件进行处理 (例如，情感分析)。
-   **随机数生成**: 在指定范围内生成随机数。
-   **模型切换**: 允许用户切换对话模型。
-   **提示词设置**: 允许用户设置或重置对话模型的提示词。

## 项目结构

-   `main.py`: 机器人主程序，处理 WebSocket 连接和消息分发。
-   `bigmodel.py`: 大模型相关功能的实现。
-   `services.py`: 集成各种外部服务（天气、诗词、一言、Bilibili、Minecraft 等）的实现。
-   `settings.py`: 项目配置文件（需要手动创建和配置）。
-   `settings-template.py`: `settings.py` 的模板文件。
-   `host_file.py`: 可能用于托管文件或提供本地服务的脚本。
-   `spider.py`: 爬虫相关功能（目前在 main.py 中未直接使用）。
-   `.gitignore`: Git 版本控制忽略文件。
-   `LICENSE`: 项目许可证文件。
-   `run.bat`: Windows 启动脚本。
-   `assets/`: 存放资源的目录。
-   `files/`: 存放机器人运行时生成或使用的文件的目录。

## 环境依赖

项目依赖于 Python 环境以及 `requirements.txt` 中列出的库（如果存在）。此外，它还需要访问一些外部服务和本地运行的配套服务（如 `localhost:4856` 和 `127.0.0.1:3001`），这些服务的具体设置请参考相关文档或代码。

## 安装与运行

1.  **克隆项目**:
    ```bash
    git clone <项目仓库地址>
    cd qqbot
    ```
2.  **安装依赖**:
    ```bash
    pip install -r requirements.txt
    ```
    （请确保项目根目录下有 `requirements.txt` 文件，如果没有，请根据代码中的导入手动安装所需库，如 `websockets`, `requests`, `asyncio` 等）。
3.  **配置**:
    复制 `settings-template.py` 为 `settings.py`，并根据需要修改其中的配置项（如 QQ 机器人 ID、名称、API 密钥等）。
    ```bash
    copy settings-template.py settings.py
    ```
    编辑 `settings.py` 文件。
4.  **运行**:
    使用 `run.bat` 脚本或直接运行 `main.py` 启动机器人。
    ```bash
    run.bat
    ```
    或
    ```bash
    python main.py
    ```

## 群聊命令

以下是机器人目前支持的群聊命令：

-   `.ping`: 测试机器人是否在线。
-   `.stop`: 停止机器人（可能需要手动重启）。
-   `.tar [你的问题]`: 进行塔罗牌占卜。
-   `.luck`: 获取每日运势。
-   `.help`: 获取帮助文档链接。
-   `.rst`: 清除当前群聊的聊天记录缓存。
-   `.vid`: 结合图片和音频文件生成视频（具体用法参见代码实现）。
-   `.pmt`: 重置当前群聊的大模型提示词为默认值。
-   `.pmt [新提示词]`: 设置当前群聊的大模型提示词。
-   `.rdm`: 在当前设置的范围内生成一个随机数。
-   `.rdm [范围1] [范围2]`: 设置随机数生成的范围。
-   `.mdl [模型名称]`: 设置当前群聊使用的大模型。
-   `.mdl ls/list/help`: 查看可用的大模型列表。

## 注意事项

-   私人消息处理功能在 `main.py` 中被注释掉了，默认不启用。
-   部分功能依赖于特定的外部 API 或本地服务，请确保这些服务正常运行并已正确配置。
-   首次运行可能需要初始化数据库（根据 `fetch_db` 和 `db` 函数的实现）。